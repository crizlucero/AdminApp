// This file has been autogenerated from a class added in the UI designer.

using System;

using Foundation;
using UIKit;
using System.Collections.Generic;
using WorklabsMx.iOS.Helpers;
using WorklabsMx.Enum;
using WorklabsMx.Models;
using System.Threading.Tasks;
using WorklabsMx.Controllers;
using BigTed;
using WorklabsMx.Helpers;
using SWRevealViewControllerBinding;

namespace WorklabsMx.iOS
{


    public interface EventosHeader
    {
        void Buscando(string Texto);
    }

	public partial class EscritorioHeaderCell : UITableViewCell
	{

        public EventosHeader EventosHeaderDelegate;

		public EscritorioHeaderCell (IntPtr handle) : base (handle)
		{

		}

        async internal void UpdateCell()
        {
            var Usuario = MenuHelper.Usuario;
            if (Usuario != null)
            {
                lblNombre.Text = Usuario.Usuario_Nombre;
                lblProfesion.Text = Usuario.Usuario_Puesto;
 

               await GetImagenesPost(Usuario);
            }

            srbBuscarComunidad.TextChanged += (sender, e) => {
                EventosHeaderDelegate.Buscando(e.SearchText);
            };

        }



        async Task GetImagenesPost(UsuarioModel Usuario)
        {
            UIImage ReescalImage = new UIImage();
            if ((Usuario.Usuario_Fotografia != "" && Usuario.Usuario_Fotografia != null))
            {
                await Task.Run(() =>
                {
                    if (Usuario.Usuario_Fotografia_Perfil == null)
                    {
                        if (Usuario.Usuario_Fotografia != "user_male.png")
                        {
                            Usuario.Usuario_Fotografia_Perfil = new UploadImages().DownloadFileFTP(Usuario.Usuario_Fotografia, MenuHelper.ProfileImagePath);
                        }
                    }
                    var data = NSData.FromArray(Usuario.Usuario_Fotografia_Perfil);
                    var uiimage = UIImage.LoadFromData(data);
                    ReescalImage = uiimage;
                });
            }
            impPublicar.Image = ReescalImage;
        }


        public UIImageView getImagenPerfil()
        {
            return this.impPublicar;
        }

        partial void btnPublicar_TouchUpInside(UIButton sender)
        {
            
        }



    }


}
